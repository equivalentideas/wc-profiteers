%h1 Who profits from WestConnex?
%p.lede
  These #{@contractors.count} companies have been contracted by the NSW Government.
  So far, their #{pluralize(Contract.count, "contracts")} are worth #{number_to_currency(Contract.sum(:value), precision: 0)}.
%ul.contractors
  - @contractors.each do |contractor|
    %li.contractor
      %header
        %h2.contractor-name= contractor.name
        %span.contractor-value= number_to_currency(contractor.total_est_contract_value, precision: 0)
        - if contractor.website
          %p= link_to simple_url(contractor.website), contractor.website, class: 'contractor-website'
      %h3.contract-counter= pluralize(contractor.contracts.count, "contract")
      %ul.contracts
        - contractor.contracts.each do |contract|
          %li.contract
            %p.contract-description
              “#{link_to(contract.description, contract.url, title: "View the contract listing at tenders.gov.nsw")}”.
            %dl.contract-data-list
              %dt Value:
              %dd.contract-value #{number_to_currency(contract.value, precision: 0)}
              %dt Period:
              %dd.contract-duration #{contract.start_date} – #{contract.end_date}
